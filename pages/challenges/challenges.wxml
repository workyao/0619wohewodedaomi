<!--pages/challenges/challenges.wxml-->
<view class="page-container desert-pattern">
  <!-- é¡¶éƒ¨æ¨ªå¹… -->
  <view class="banner-section">
    <view class="banner-card">
      <view class="banner-content">
        <text class="banner-title">ğŸ† ä¸»é¢˜æ‰“å¡æŒ‘æˆ˜</text>
        <text class="banner-desc">å‚ä¸ä¸»é¢˜æŒ‘æˆ˜ï¼Œè·å¾—ä¸“å±å‹‹ç« </text>
      </view>
      <view class="banner-stats">
        <text class="stats-text">å·²å®Œæˆ {{completedChallenges}} ä¸ªæŒ‘æˆ˜</text>
      </view>
    </view>
  </view>

  <!-- è¿›è¡Œä¸­çš„æŒ‘æˆ˜ -->
  <view class="active-challenges-section" wx:if="{{activeChallenges.length > 0}}">
    <view class="section-title">
      <text class="title-text">ğŸ”¥ è¿›è¡Œä¸­çš„æŒ‘æˆ˜</text>
    </view>
    
    <view class="challenges-list">
      <view 
        class="challenge-card card active"
        wx:for="{{activeChallenges}}" 
        wx:key="id"
        bindtap="viewChallenge"
        data-challenge="{{item}}"
      >
        <view class="card-body">
          <view class="challenge-header">
            <view class="challenge-icon">{{item.icon}}</view>
            <view class="challenge-info">
              <text class="challenge-title">{{item.title}}</text>
              <text class="challenge-desc">{{item.description}}</text>
            </view>
            <view class="challenge-status">
              <text class="status-badge active">è¿›è¡Œä¸­</text>
            </view>
          </view>
          
          <view class="challenge-progress">
            <view class="progress-info">
              <text class="progress-text">è¿›åº¦ï¼š{{item.progress}}/{{item.target}}</text>
              <text class="progress-percent">{{item.progressPercent}}%</text>
            </view>
            <view class="progress-bar">
              <view 
                class="progress-fill" 
                style="width: {{item.progressPercent}}%"
              ></view>
            </view>
          </view>
          
          <view class="challenge-reward">
            <text class="reward-label">å¥–åŠ±ï¼š</text>
            <text class="reward-badge">{{item.reward.name}}</text>
          </view>
          
          <view class="challenge-time">
            <text class="time-label">å‰©ä½™æ—¶é—´ï¼š</text>
            <text class="time-value">{{item.remainingTime}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¯å‚ä¸çš„æŒ‘æˆ˜ -->
  <view class="available-challenges-section">
    <view class="section-title">
      <text class="title-text">ğŸ“‹ å¯å‚ä¸çš„æŒ‘æˆ˜</text>
    </view>
    
    <view class="challenges-list">
      <view 
        class="challenge-card card"
        wx:for="{{availableChallenges}}" 
        wx:key="id"
        bindtap="viewChallenge"
        data-challenge="{{item}}"
      >
        <view class="card-body">
          <view class="challenge-header">
            <view class="challenge-icon">{{item.icon}}</view>
            <view class="challenge-info">
              <text class="challenge-title">{{item.title}}</text>
              <text class="challenge-desc">{{item.description}}</text>
            </view>
            <view class="challenge-difficulty">
              <text class="difficulty-badge {{item.difficulty}}">{{item.difficultyText}}</text>
            </view>
          </view>
          
          <view class="challenge-details">
            <view class="detail-item">
              <text class="detail-label">ç›®æ ‡ï¼š</text>
              <text class="detail-value">{{item.targetText}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">æ—¶é•¿ï¼š</text>
              <text class="detail-value">{{item.duration}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">å‚ä¸äººæ•°ï¼š</text>
              <text class="detail-value">{{item.participantCount}}äºº</text>
            </view>
          </view>
          
          <view class="challenge-reward">
            <text class="reward-label">å¥–åŠ±ï¼š</text>
            <text class="reward-badge">{{item.reward.name}}</text>
            <text class="reward-desc">{{item.reward.description}}</text>
          </view>
          
          <view class="challenge-actions">
            <button 
              class="btn btn-primary btn-small"
              bindtap="joinChallenge"
              data-challenge="{{item}}"
            >
              å‚ä¸æŒ‘æˆ˜
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å·²å®Œæˆçš„æŒ‘æˆ˜ -->
  <view class="completed-challenges-section" wx:if="{{completedChallengesList.length > 0}}">
    <view class="section-title">
      <text class="title-text">âœ… å·²å®Œæˆçš„æŒ‘æˆ˜</text>
    </view>
    
    <view class="challenges-list">
      <view 
        class="challenge-card card completed"
        wx:for="{{completedChallengesList}}" 
        wx:key="id"
        bindtap="viewChallenge"
        data-challenge="{{item}}"
      >
        <view class="card-body">
          <view class="challenge-header">
            <view class="challenge-icon">{{item.icon}}</view>
            <view class="challenge-info">
              <text class="challenge-title">{{item.title}}</text>
              <text class="challenge-desc">{{item.description}}</text>
            </view>
            <view class="challenge-status">
              <text class="status-badge completed">å·²å®Œæˆ</text>
            </view>
          </view>
          
          <view class="challenge-achievement">
            <view class="achievement-badge">
              <text class="badge-icon">{{item.reward.icon}}</text>
              <text class="badge-name">{{item.reward.name}}</text>
            </view>
            <text class="completion-time">å®Œæˆæ—¶é—´ï¼š{{item.completionTime}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æŒ‘æˆ˜è§„åˆ™è¯´æ˜ -->
  <view class="rules-section">
    <view class="rules-card card">
      <view class="card-header">
        <text class="card-title">ğŸ“– æŒ‘æˆ˜è§„åˆ™</text>
      </view>
      <view class="card-body">
        <view class="rules-list">
          <view class="rule-item">
            <text class="rule-number">1.</text>
            <text class="rule-text">æ¯ä¸ªæŒ‘æˆ˜éƒ½æœ‰ç‰¹å®šçš„æ—¶é—´é™åˆ¶ï¼Œè¯·åœ¨è§„å®šæ—¶é—´å†…å®Œæˆ</text>
          </view>
          <view class="rule-item">
            <text class="rule-number">2.</text>
            <text class="rule-text">å®ŒæˆæŒ‘æˆ˜åå°†è·å¾—ä¸“å±å‹‹ç« å’Œç§°å·å¥–åŠ±</text>
          </view>
          <view class="rule-item">
            <text class="rule-number">3.</text>
            <text class="rule-text">æŒ‘æˆ˜è¿›åº¦å®æ—¶æ›´æ–°ï¼Œå¯éšæ—¶æŸ¥çœ‹å®Œæˆæƒ…å†µ</text>
          </view>
          <view class="rule-item">
            <text class="rule-number">4.</text>
            <text class="rule-text">éƒ¨åˆ†æŒ‘æˆ˜éœ€è¦è¿ç»­å®Œæˆï¼Œä¸­æ–­åéœ€é‡æ–°å¼€å§‹</text>
          </view>
          <view class="rule-item">
            <text class="rule-number">5.</text>
            <text class="rule-text">æŒ‘æˆ˜å¥–åŠ±å°†è‡ªåŠ¨å‘æ”¾åˆ°ä¸ªäººè´¦æˆ·</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-mask" wx:if="{{loading}}">
  <view class="loading-content">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>
